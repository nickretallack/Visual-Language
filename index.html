<!doctype html>
<html ng:app="vislang">
<head>
<title>Visual Language</title>
<script src="common/raphael.js"></script>
<script src="common/angular-1.0.0rc6.js"></script>
<script src="vector2.js"></script>
<script src="common/underscore.js"></script>
<script src="common/minified/jquery.js"></script>
<script src="common/uuid.js"></script>
<script src="stuff.js"></script>
<link rel="stylesheet" href="common/reset.css">
<link rel="stylesheet" href="style.css">
</head>

<body ng:controller="Controller">

<ng:switch on="current_object.type">

<div ng:switch-when="subroutine">
<h2><input ng:model="current_object.name"></h2>

<div id="subroutine" ng-style="{'width':editor_size.x+'px', 'height':editor_size.y+'px'}">
<div class="node" ng-repeat="node in current_object.nodes" ng-style="position(node)">
<h1>{{node.text}}</h1>
<table class="inputs-outputs" io="node"></table>

</div>
</div>

<div id="inputs_editor">
<h3>Inputs</h3>
<ul><li ng:repeat="input in current_object.inputs">
    <input ng:model="input.text">
</li></ul>
</div>

<div id="outputs_editor">
<h3>Outputs</h3>
<ul><li ng:repeat="output in current_object.outputs">
    <input ng:model="output.text">
</li></ul>
</div>

</div>

<div ng:switch-when="literal">
<h2><input ng:model="current_object.text"></h2>
</div>

<div ng:switch-when="builtin" id="builtin_editor">
<h2><input ng:model="current_object.name"></h2>
<p>Inputs: <input type="list" ng:model="current_object.inputs"></p>
<p>Outputs: <input type="list" ng:model="current_object.outputs"></p>
Memo Implementation:
<textarea rows="10" cols="50" ng:model="current_object.memo_implementation"></textarea>
Output Implementation:
<textarea rows="10" cols="50" ng:model="current_object.output_implementation"></textarea>
</div>

</ng:switch>

</div>

<div id="tools">
<h2>Import/Export</h2>
<textarea ng:model="import_export_text"></textarea>
<p>
<button ng:click="import()">Import</button>
<button ng:click="export_all()">Export All</button>
<button ng:click="revert()">Revert to Default State</button>
<button ng:click="load_example_programs()">Revert Example Functions</button>
</p>

<h2>Functions</h2>
<ul><li ng:repeat="(id, subroutine) in subroutines">
    <a ng:click="edit(subroutine)">edit</a>
    <a ng:click="export_subroutine(subroutine)">export</a>
    <a ng:click="delete_subroutine(subroutine)">delete</a>
    <a ng:show="current_object.type == 'subroutine'" ng:click="use_subroutine(subroutine)">use</a>
    <a ng:show="current_object.type == 'subroutine'" ng:click="use_subroutine_value(subroutine)">value</a>
    <span class="name">{{subroutine.name}}</span>
    (<span ng:repeat="input in subroutine.inputs">{{input.text}} </span> -&gt;
    <span ng:repeat="output in subroutine.outputs">
        <a ng:click="run_subroutine(subroutine, output.index)">{{output.text}}</a>
    </span>)
</li></ul>
<form ng:submit="add_subroutine()">
<p>Name:<input ng:model="new_subroutine.name"></p>
<p>Inputs:<input type="list" ng:model="new_subroutine.inputs"></p>
<p>Outputs:<input type="list" ng:model="new_subroutine.outputs"></p>
<button>Create Function</button> </form>

<h2>Literals (JSON)</h2>
<form ng:submit="use_literal()"> <input ng:model="literal_text"> <button>Use Literal</button> </form>

<h2>Builtins
<button ng:click="add_builtin()">New Builtin</button>
</h2>
<ul id="builtins"><li ng:repeat="(id, builtin) in builtins">
    <a ng:click="edit(builtin)">edit</a>
    <a ng:click="export_builtin(builtin)">export</a>
    <a ng:click="delete_builtin(builtin)">delete</a>
    <a ng:show="current_object.type == 'subroutine'" ng:click="use_builtin(builtin)">use</a>
    <span class="name">{{builtin.name}}</span>
    (<span ng:repeat="input in builtin.inputs">{{input}} </span> -&gt;
    <span ng:repeat="output in builtin.outputs">
        <a ng:click="run_builtin(builtin, $index)">{{output}}</a>
    </span>)
</li></ul>

</body>
</html>
