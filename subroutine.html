{{name_node(current_object)}}
<div ng-switch="current_object.type" any-subroutine="current_object">

<div ng-switch-when="graph" subroutine="current_object">

<div id="subroutine" ng-keydown="console.log('um')">
    <canvas id="connections" connections="current_object"></canvas>
    <div id="selection" ng-style="selection_style()"></div>
    <div class="subroutine-input" ng-repeat="input in current_object.inputs" ng-style="{'top':(($index+1) * editor_size.y / (current_object.inputs.length+1)) + 'px'}">
        <div nib="input" node="current_object"></div>
        <input ng-model="input.text" shrinky-input="input.text">
        <a ng-click="delete_input(input)">-</a>
    </div>
    <a id="new-input" ng-click="new_input(subroutine)">+Input</a>

    <div class="subroutine-output" ng-repeat="output in current_object.outputs" ng-style="{'top':(($index+1) * editor_size.y / (current_object.outputs.length+1)) + 'px'}">
        <a ng-click="delete_output(output)">-</a>
        <input ng-model="output.text" shrinky-input="output.text">
        <div nib="output" node="current_object"></div>
        <div><a ng-click="evaluate_output(output)">evaluate</a></div>
    </div>
    <a id="new-output" ng-click="new_output(subroutine)">+Output</a>


    <div class="node" ng-repeat="node in current_object.nodes" node="node" ng-style="position(node)" ng-mousedown="click_node(node, $event)" ng-dblclick="edit_node(node, $event)" ng-rightclick="" ng-class="{selected:selected(node)}">
        <ul class="unstyled"><li ng-repeat="output in node.implementation.outputs" class="output">
        	<div nib="output" node="node"></div>
        	{{output.text}}
        </li></ul>

        <div class="node-title">{{node.implementation | text_or_id}}</div>

        <ul class="unstyled"><li ng-repeat="input in node.implementation.inputs" class="input">
        	{{input.text}}
        	<div nib="input" node="node"></div>
        </li></ul>
    </div>
</div>


<div id="editor-options">
    <div id="title-row">
    <input ng-model="current_object.text" shrinky-input="current_object | text_or_id" class="title" placeholder="{{current_object.id}}"> options
    </div>

    <div id="selection-row" class="btn-toolbar">
        <a class="btn" ng-show="can_delete_selection()" ng-click="delete_selection()">Delete</a>
        <a class="btn" ng-show="can_edit_selected_node()" ng-click="edit_node(selection[0])">Edit</a>
        <a class="btn" ng-show="can_bust_selected_node()" ng-click="bust_selected_node()">Bust</a>
        <a class="btn" ng-show="can_join_selected_nodes()" ng-click="join_selected_nodes()">Join</a>
    </div>
</div>

</div>

<div ng-switch-when="literal">
<h2><input ng:model="current_object.text"></h2>
</div>

<div ng-switch-when="javascript" id="builtin_editor">
    <input ng-model="current_object.text" class="title" shrinky-input="current_object | text_or_id" placeholder="{{current_object.id}}">
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span6">

                <h3>Outputs</h3>
                <div ng-repeat="output in current_object.outputs">
                    <input ng-model="output.text">
                    <a ng-click="delete_output(output)">-</a>
                    <a ng-click="evaluate_output(output)">evaluate</a>
                </div>
                <a ng-click="new_output(current_object)">+Output</a>
            </div>
            <div class="span6">

                <h3>Inputs</h3>
                <div ng-repeat="input in current_object.inputs">
                    <input ng-model="input.text">
                    <a ng-click="delete_input(input)">-</a>
                </div>
                <a ng-click="new_input(current_object)">+Input</a>
            </div>
        </div>

        <div class="row-fluid">
            <div class="span6">
                <h3>Memo Implementation</h3>
                <div ace ng-model="current_object.memo_implementation" style="position:relative; width:100%; height:500px"></div>
            </div>
            <div class="span6">
                <h3>Output Implementation</h3>
                <div ace ng-model="current_object.output_implementation" style="position:relative; width:100%; height:500px"></div>
            </div>
        </div>
    </div>
</div>
</div>

</div>

